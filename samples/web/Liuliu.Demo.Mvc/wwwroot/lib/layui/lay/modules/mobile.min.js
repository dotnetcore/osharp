layui.define(function(e){e("layui.mobile",layui.v)}),layui.define(function(e){"use strict";function t(e){this.tpl=e}var r={open:"{{",close:"}}"},o=function(e,t,n){var i=["#([\\s\\S])+?","([^{#}])*?"][e||0];return c((t||"")+r.open+i+r.close+(n||""))},l=function(e){return String(e||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},s=function(e,t){var n="Laytpl Error：";return"object"==typeof console&&console.error(n+e+"\n"+(t||"")),n+e},c=function(e){return new RegExp(e,"g")};t.pt=t.prototype,window.errors=0,t.pt.parse=function(e,t){var n=e,i=c("^"+r.open+"#",""),a=c(r.close+"$","");e='"use strict";var view = "'+(e=e.replace(/\s+|\r|\t|\n/g," ").replace(c(r.open+"#"),r.open+"# ").replace(c(r.close+"}"),"} "+r.close).replace(/\\/g,"\\\\").replace(c(r.open+"!(.+?)!"+r.close),function(e){return e.replace(c("^"+r.open+"!"),"").replace(c("!"+r.close),"").replace(c(r.open+"|"+r.close),function(e){return e.replace(/(.)/g,"\\$1")})}).replace(/(?="|')/g,"\\").replace(o(),function(e){return'";'+(e=e.replace(i,"").replace(a,"")).replace(/\\/g,"")+';view+="'}).replace(o(1),function(e){var t='"+(';return e.replace(/\s/g,"")===r.open+r.close?"":(e=e.replace(c(r.open+"|"+r.close),""),/^=/.test(e)&&(e=e.replace(/^=/,""),t='"+_escape_('),t+e.replace(/\\/g,"")+')+"')}))+'";return view;';try{return this.cache=e=new Function("d, _escape_",e),e(t,l)}catch(e){return delete this.cache,s(e,n)}},t.pt.render=function(e,t){var n,i=this;return e?(n=i.cache?i.cache(e,l):i.parse(i.tpl,e),t?void t(n):n):s("no data")};function n(e){return"string"!=typeof e?s("Template not found"):new t(e)}n.config=function(e){for(var t in e=e||{})r[t]=e[t]},n.v="1.2.0",e("laytpl",n)}),layui.define(function(e){"use strict";function s(e){return c.querySelectorAll(e)}function t(e){this.config=d.extend(e),this.view()}var c=(window,document),u="getElementsByClassName",i={type:0,shade:!0,shadeClose:!0,fixed:!0,anim:"scale"},d={extend:function(e){var t=JSON.parse(JSON.stringify(i));for(var n in e)t[n]=e[n];return t},timer:{},end:{},touch:function(e,t){e.addEventListener("click",function(e){t.call(this,e)},!1)}},f=0,p=["layui-m-layer"];t.prototype.view=function(){var e=this,n=e.config,t=c.createElement("div");e.id=t.id=p[0]+f,t.setAttribute("class",p[0]+" "+p[0]+(n.type||0)),t.setAttribute("index",f);var i,a,r=(i="object"==typeof n.title,n.title?'<h3 style="'+(i?n.title[1]:"")+'">'+(i?n.title[0]:n.title)+"</h3>":""),o=function(){"string"==typeof n.btn&&(n.btn=[n.btn]);var e,t=(n.btn||[]).length;return 0!==t&&n.btn?(e='<span yes type="1">'+n.btn[0]+"</span>",2===t&&(e='<span no type="0">'+n.btn[1]+"</span>"+e),'<div class="layui-m-layerbtn">'+e+"</div>"):""}();n.fixed||(n.top=n.hasOwnProperty("top")?n.top:100,n.style=n.style||"",n.style+=" top:"+(c.body.scrollTop+n.top)+"px"),2===n.type&&(n.content='<i></i><i class="layui-m-layerload"></i><i></i><p>'+(n.content||"")+"</p>"),n.skin&&(n.anim="up"),"msg"===n.skin&&(n.shade=!1),t.innerHTML=(n.shade?"<div "+("string"==typeof n.shade?'style="'+n.shade+'"':"")+' class="layui-m-layershade"></div>':"")+'<div class="layui-m-layermain" '+(n.fixed?"":'style="position:static;"')+'><div class="layui-m-layersection"><div class="layui-m-layerchild '+(n.skin?"layui-m-layer-"+n.skin+" ":"")+(n.className?n.className:"")+" "+(n.anim?"layui-m-anim-"+n.anim:"")+'" '+(n.style?'style="'+n.style+'"':"")+">"+r+'<div class="layui-m-layercont">'+n.content+"</div>"+o+"</div></div></div>",n.type&&2!==n.type||1<=(a=c[u](p[0]+n.type)).length&&m.close(a[0].getAttribute("index")),document.body.appendChild(t);var l=e.elem=s("#"+e.id)[0];n.success&&n.success(l),e.index=f++,e.action(n,l)},t.prototype.action=function(e,t){var n=this;e.time&&(d.timer[n.index]=setTimeout(function(){m.close(n.index)},1e3*e.time));function i(){0==this.getAttribute("type")?(e.no&&e.no(),m.close(n.index)):e.yes?e.yes(n.index):m.close(n.index)}var a;if(e.btn)for(var r=t[u]("layui-m-layerbtn")[0].children,o=r.length,l=0;l<o;l++)d.touch(r[l],i);e.shade&&e.shadeClose&&(a=t[u]("layui-m-layershade")[0],d.touch(a,function(){m.close(n.index,e.end)})),e.end&&(d.end[n.index]=e.end)};var m={v:"2.0 m",index:f,open:function(e){return new t(e||{}).index},close:function(e){var t=s("#"+p[0]+e)[0];t&&(t.innerHTML="",c.body.removeChild(t),clearTimeout(d.timer[e]),delete d.timer[e],"function"==typeof d.end[e]&&d.end[e](),delete d.end[e])},closeAll:function(){for(var e=c[u](p[0]),t=0,n=e.length;t<n;t++)m.close(0|e[0].getAttribute("index"))}};e("layer-mobile",m)}),layui.define(function(e){var s,o,c,i,l,n,a,r,u,d,f,p,t,m,h,y,v,g,b,x,w,C,E,S,T,j,N,k,A,O,L,P,D=(r=(a=[]).concat,u=a.filter,d=a.slice,f=window.document,p={},t={},m={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},h=/^\s*<(\w+|!)[^>]*>/,y=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,g=/^(?:body|html)$/i,b=/([A-Z])/g,x=["val","css","html","text","data","width","height","offset"],w=f.createElement("table"),C=f.createElement("tr"),E={tr:f.createElement("tbody"),tbody:w,thead:w,tfoot:w,td:C,th:C,"*":f.createElement("div")},S=/complete|loaded|interactive/,T=/^[\w-]*$/,N=(j={}).toString,k={},A=f.createElement("div"),O={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},L=Array.isArray||function(e){return e instanceof Array},k.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var i,a=e.parentNode,r=!a;return r&&(a=A).appendChild(e),i=~k.qsa(a,t).indexOf(e),r&&A.removeChild(e),i},l=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},n=function(n){return u.call(n,function(e,t){return n.indexOf(e)==t})},k.fragment=function(e,t,n){var i,a,r;return y.test(e)&&(i=c(f.createElement(RegExp.$1))),i||(e.replace&&(e=e.replace(v,"<$1></$2>")),t===s&&(t=h.test(e)&&RegExp.$1),t in E||(t="*"),(r=E[t]).innerHTML=""+e,i=c.each(d.call(r.childNodes),function(){r.removeChild(this)})),_(n)&&(a=c(i),c.each(n,function(e,t){-1<x.indexOf(e)?a[e](t):a.attr(e,t)})),i},k.Z=function(e,t){return new J(e,t)},k.isZ=function(e){return e instanceof k.Z},k.init=function(e,t){var n,i;if(!e)return k.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&h.test(e))n=k.fragment(e,RegExp.$1,t),e=null;else{if(t!==s)return c(t).find(e);n=k.qsa(f,e)}else{if(M(e))return c(f).ready(e);if(k.isZ(e))return e;if(L(e))i=e,n=u.call(i,function(e){return null!=e});else if(H(e))n=[e],e=null;else if(h.test(e))n=k.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==s)return c(t).find(e);n=k.qsa(f,e)}}return k.Z(n,e)},(c=function(e,t){return k.init(e,t)}).extend=function(t){var n,e=d.call(arguments,1);return"boolean"==typeof t&&(n=t,t=e.shift()),e.forEach(function(e){!function e(t,n,i){for(o in n)i&&(_(n[o])||L(n[o]))?(_(n[o])&&!_(t[o])&&(t[o]={}),L(n[o])&&!L(t[o])&&(t[o]=[]),e(t[o],n[o],i)):n[o]!==s&&(t[o]=n[o])}(t,e,n)}),t},k.qsa=function(e,t){var n,i="#"==t[0],a=!i&&"."==t[0],r=i||a?t.slice(1):t,o=T.test(r);return e.getElementById&&o&&i?(n=e.getElementById(r))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:d.call(o&&!i&&e.getElementsByClassName?a?e.getElementsByClassName(r):e.getElementsByTagName(t):e.querySelectorAll(t))},c.contains=f.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t=t&&t.parentNode;)if(t===e)return!0;return!1},c.type=$,c.isFunction=M,c.isWindow=F,c.isArray=L,c.isPlainObject=_,c.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},c.isNumeric=function(e){var t=Number(e),n=typeof e;return null!=e&&"boolean"!=n&&("string"!=n||e.length)&&!isNaN(t)&&isFinite(t)||!1},c.inArray=function(e,t,n){return a.indexOf.call(t,e,n)},c.camelCase=l,c.trim=function(e){return null==e?"":String.prototype.trim.call(e)},c.uuid=0,c.support={},c.expr={},c.noop=function(){},c.map=function(e,t){var n,i,a,r,o=[];if(z(e))for(i=0;i<e.length;i++)null!=(n=t(e[i],i))&&o.push(n);else for(a in e)null!=(n=t(e[a],a))&&o.push(n);return 0<(r=o).length?c.fn.concat.apply([],r):r},c.each=function(e,t){var n,i;if(z(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(i in e)if(!1===t.call(e[i],i,e[i]))return e;return e},c.grep=function(e,t){return u.call(e,t)},window.JSON&&(c.parseJSON=JSON.parse),c.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){j["[object "+t+"]"]=t.toLowerCase()}),c.fn={constructor:k.Z,length:0,forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,splice:a.splice,indexOf:a.indexOf,concat:function(){for(var e,t=[],n=0;n<arguments.length;n++)e=arguments[n],t[n]=k.isZ(e)?e.toArray():e;return r.apply(k.isZ(this)?this.toArray():this,t)},map:function(n){return c(c.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return c(d.apply(this,arguments))},ready:function(e){return S.test(f.readyState)&&f.body?e(c):f.addEventListener("DOMContentLoaded",function(){e(c)},!1),this},get:function(e){return e===s?d.call(this):this[0<=e?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(n){return a.every.call(this,function(e,t){return!1!==n.call(e,t,e)}),this},filter:function(t){return M(t)?this.not(this.not(t)):c(u.call(this,function(e){return k.matches(e,t)}))},add:function(e,t){return c(n(this.concat(c(e,t))))},is:function(e){return 0<this.length&&k.matches(this[0],e)},not:function(t){var n,i=[];return M(t)&&t.call!==s?this.each(function(e){t.call(this,e)||i.push(this)}):(n="string"==typeof t?this.filter(t):z(t)&&M(t.item)?d.call(t):c(t),this.forEach(function(e){n.indexOf(e)<0&&i.push(e)})),c(i)},has:function(e){return this.filter(function(){return H(e)?c.contains(this,e):c(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!H(e)?e:c(e)},last:function(){var e=this[this.length-1];return e&&!H(e)?e:c(e)},find:function(e){var n=this;return e?"object"==typeof e?c(e).filter(function(){var t=this;return a.some.call(n,function(e){return c.contains(e,t)})}):1==this.length?c(k.qsa(this[0],e)):this.map(function(){return k.qsa(this,e)}):c()},closest:function(n,i){var a=[],r="object"==typeof n&&c(n);return this.each(function(e,t){for(;t&&!(r?0<=r.indexOf(t):k.matches(t,n));)t=t!==i&&!q(t)&&t.parentNode;t&&a.indexOf(t)<0&&a.push(t)}),c(a)},parents:function(e){for(var t=[],n=this;0<n.length;)n=c.map(n,function(e){if((e=e.parentNode)&&!q(e)&&t.indexOf(e)<0)return t.push(e),e});return V(t,e)},parent:function(e){return V(n(this.pluck("parentNode")),e)},children:function(e){return V(this.map(function(){return B(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||d.call(this.childNodes)})},siblings:function(e){return V(this.map(function(e,t){return u.call(B(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return c.map(this,function(e){return e[t]})},show:function(){return this.each(function(){var e,t,n;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,p[e]||(t=f.createElement(e),f.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),p[e]=n),p[e]))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var n,i,a=M(t);return this[0]&&!a&&(n=c(t).get(0),i=n.parentNode||1<this.length),this.each(function(e){c(this).wrapAll(a?t.call(this,e):i?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){c(this[0]).before(e=c(e));for(var t;(t=e.children()).length;)e=t.first();c(e).append(this)}return this},wrapInner:function(a){var r=M(a);return this.each(function(e){var t=c(this),n=t.contents(),i=r?a.call(this,e):a;n.length?n.wrapAll(i):t.append(i)})},unwrap:function(){return this.parent().each(function(){c(this).replaceWith(c(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=c(this);(t===s?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(e){return c(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return c(this.pluck("nextElementSibling")).filter(e||"*")},html:function(n){return 0 in arguments?this.each(function(e){var t=this.innerHTML;c(this).empty().append(U(this,n,e,t))}):0 in this?this[0].innerHTML:null},text:function(n){return 0 in arguments?this.each(function(e){var t=U(this,n,e,this.textContent);this.textContent=null==t?"":""+t}):0 in this?this.pluck("textContent").join(""):null},attr:function(t,n){var e;return"string"!=typeof t||1 in arguments?this.each(function(e){if(1===this.nodeType)if(H(t))for(o in t)Y(this,o,t[o]);else Y(this,t,U(this,n,e,this.getAttribute(t)))}):0 in this&&1==this[0].nodeType&&null!=(e=this[0].getAttribute(t))?e:s},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){Y(this,e)},this)})},prop:function(t,n){return t=O[t]||t,1 in arguments?this.each(function(e){this[t]=U(this,n,e,this[t])}):this[0]&&this[0][t]},removeProp:function(e){return e=O[e]||e,this.each(function(){delete this[e]})},data:function(e,t){var n="data-"+e.replace(b,"-$1").toLowerCase(),i=1 in arguments?this.attr(n,t):this.attr(n);return null!==i?W(i):s},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=U(this,t,e,this.value)})):this[0]&&(this[0].multiple?c(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(r){if(r)return this.each(function(e){var t=c(this),n=U(this,r,e,t.offset()),i=t.offsetParent().offset(),a={top:n.top-i.top,left:n.left-i.left};"static"==t.css("position")&&(a.position="relative"),t.css(a)});if(!this.length)return null;if(f.documentElement!==this[0]&&!c.contains(f.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,t){if(arguments.length<2){var n=this[0];if("string"==typeof e){if(!n)return;return n.style[l(e)]||getComputedStyle(n,"").getPropertyValue(e)}if(L(e)){if(!n)return;var i={},a=getComputedStyle(n,"");return c.each(e,function(e,t){i[t]=n.style[l(t)]||a.getPropertyValue(t)}),i}}var r="";if("string"==$(e))t||0===t?r=I(e)+":"+Z(e,t):this.each(function(){this.style.removeProperty(I(e))});else for(o in e)e[o]||0===e[o]?r+=I(o)+":"+Z(o,e[o])+";":this.each(function(){this.style.removeProperty(I(o))});return this.each(function(){this.style.cssText+=";"+r})},index:function(e){return e?this.indexOf(c(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&a.some.call(this,function(e){return this.test(X(e))},R(e))},addClass:function(n){return n?this.each(function(e){var t;"className"in this&&(i=[],t=X(this),U(this,n,e,t).split(/\s+/g).forEach(function(e){c(this).hasClass(e)||i.push(e)},this),i.length&&X(this,t+(t?" ":"")+i.join(" ")))}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===s)return X(this,"");i=X(this),U(this,t,e,i).split(/\s+/g).forEach(function(e){i=i.replace(R(e)," ")}),X(this,i.trim())}})},toggleClass:function(n,i){return n?this.each(function(e){var t=c(this);U(this,n,e,X(this)).split(/\s+/g).forEach(function(e){(i===s?!t.hasClass(e):i)?t.addClass(e):t.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===s?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===s?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),i=g.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(c(e).css("margin-top"))||0,n.left-=parseFloat(c(e).css("margin-left"))||0,i.top+=parseFloat(c(t[0]).css("border-top-width"))||0,i.left+=parseFloat(c(t[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||f.body;e&&!g.test(e.nodeName)&&"static"==c(e).css("position");)e=e.offsetParent;return e})}},c.fn.detach=c.fn.remove,["width","height"].forEach(function(i){var a=i.replace(/./,function(e){return e[0].toUpperCase()});c.fn[i]=function(t){var e,n=this[0];return t===s?F(n)?n["inner"+a]:q(n)?n.documentElement["scroll"+a]:(e=this.offset())&&e[i]:this.each(function(e){(n=c(this)).css(i,U(this,t,e,n[i]()))})}}),["after","prepend","before","append"].forEach(function(t,o){var l=o%2;c.fn[t]=function(){var n,i,a=c.map(arguments,function(e){var t=[];return"array"==(n=$(e))?(e.forEach(function(e){return e.nodeType!==s?t.push(e):c.zepto.isZ(e)?t=t.concat(e.get()):void(t=t.concat(k.fragment(e)))}),t):"object"==n||null==e?e:k.fragment(e)}),r=1<this.length;return a.length<1?this:this.each(function(e,t){i=l?t:t.parentNode,t=0==o?t.nextSibling:1==o?t.firstChild:2==o?t:null;var n=c.contains(f.documentElement,i);a.forEach(function(e){if(r)e=e.cloneNode(!0);else if(!i)return c(e).remove();i.insertBefore(e,t),n&&function e(t,n){n(t);for(var i=0,a=t.childNodes.length;i<a;i++)e(t.childNodes[i],n)}(e,function(e){var t;null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||(t=e.ownerDocument?e.ownerDocument.defaultView:window).eval.call(t,e.innerHTML)})})})},c.fn[l?t+"To":"insert"+(o?"Before":"After")]=function(e){return c(e)[t](this),this}}),k.Z.prototype=J.prototype=c.fn,k.uniq=n,k.deserializeValue=W,c.zepto=k,c);function $(e){return null==e?String(e):j[N.call(e)]||"object"}function M(e){return"function"==$(e)}function F(e){return null!=e&&e==e.window}function q(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function H(e){return"object"==$(e)}function _(e){return H(e)&&!F(e)&&Object.getPrototypeOf(e)==Object.prototype}function z(e){var t=!!e&&"length"in e&&e.length,n=c.type(e);return"function"!=n&&!F(e)&&("array"==n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function I(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function R(e){return e in t?t[e]:t[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function Z(e,t){return"number"!=typeof t||m[I(e)]?t:t+"px"}function B(e){return"children"in e?d.call(e.children):c.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function J(e,t){for(var n=e?e.length:0,i=0;i<n;i++)this[i]=e[i];this.length=n,this.selector=t||""}function V(e,t){return null==t?c(e):c(e).filter(t)}function U(e,t,n,i){return M(t)?t.call(e,n,i):t}function Y(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function X(e,t){var n=e.className||"",i=n&&n.baseVal!==s;return t===s?i?n.baseVal:n:void(i?n.baseVal=t:e.className=t)}function W(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?c.parseJSON(t):t):t}catch(e){return t}}!function(u){function d(e){return e._zid||(e._zid=t++)}function o(e,t,n,i){var a,r;return(t=f(t)).ns&&(r=t.ns,a=new RegExp("(?:^| )"+r.replace(" "," .* ?")+"(?: |$)")),(C[d(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||a.test(e.ns))&&(!n||d(e.fn)===d(n))&&(!i||e.sel==i)})}function f(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function p(e,t){return e.del&&!n&&e.e in i||!!t}function m(e){return E[e]||n&&i[e]||e}function c(a,e,t,r,o,l,s){var n=d(a),c=C[n]||(C[n]=[]);e.split(/\s/).forEach(function(e){if("ready"==e)return u(document).ready(t);var n=f(e);n.fn=t,n.sel=o,n.e in E&&(t=function(e){var t=e.relatedTarget;if(!t||t!==this&&!u.contains(this,t))return n.fn.apply(this,arguments)});var i=(n.del=l)||t;n.proxy=function(e){if(!(e=y(e)).isImmediatePropagationStopped()){e.data=r;var t=i.apply(a,e._args==b?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},n.i=c.length,c.push(n),"addEventListener"in a&&a.addEventListener(m(n.e),n.proxy,p(n,s))})}function h(t,e,n,i,a){var r=d(t);(e||"").split(/\s/).forEach(function(e){o(t,e,n,i).forEach(function(e){delete C[r][e.i],"removeEventListener"in t&&t.removeEventListener(m(e.e),e.proxy,p(e,a))})})}function y(i,a){return!a&&i.isDefaultPrevented||(a=a||i,u.each(e,function(e,t){var n=a[e];i[e]=function(){return this[t]=l,n&&n.apply(a,arguments)},i[t]=S}),i.timeStamp||(i.timeStamp=Date.now()),(a.defaultPrevented!==b?a.defaultPrevented:"returnValue"in a?!1===a.returnValue:a.getPreventDefault&&a.getPreventDefault())&&(i.isDefaultPrevented=l)),i}function v(e){var t,n={originalEvent:e};for(t in e)a.test(t)||e[t]===b||(n[t]=e[t]);return y(n,e)}function g(e){return"string"==typeof e}var b,t=1,x=Array.prototype.slice,w=u.isFunction,C={},r={},n="onfocusin"in window,i={focus:"focusin",blur:"focusout"},E={mouseenter:"mouseover",mouseleave:"mouseout"};r.click=r.mousedown=r.mouseup=r.mousemove="MouseEvents",u.event={add:c,remove:h},u.proxy=function(e,t){var n=2 in arguments&&x.call(arguments,2);if(w(e)){function i(){return e.apply(t,n?n.concat(x.call(arguments)):arguments)}return i._zid=d(e),i}if(g(t))return n?(n.unshift(e[t],e),u.proxy.apply(null,n)):u.proxy(e[t],e);throw new TypeError("expected function")},u.fn.bind=function(e,t,n){return this.on(e,t,n)},u.fn.unbind=function(e,t){return this.off(e,t)},u.fn.one=function(e,t,n,i){return this.on(e,t,n,i,1)};var l=function(){return!0},S=function(){return!1},a=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,e={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};u.fn.delegate=function(e,t,n){return this.on(t,e,n)},u.fn.undelegate=function(e,t,n){return this.off(t,e,n)},u.fn.live=function(e,t){return u(document.body).delegate(this.selector,e,t),this},u.fn.die=function(e,t){return u(document.body).undelegate(this.selector,e,t),this},u.fn.on=function(t,a,n,r,o){var l,s,i=this;return t&&!g(t)?(u.each(t,function(e,t){i.on(e,a,n,t,o)}),i):(g(a)||w(r)||!1===r||(r=n,n=a,a=b),r!==b&&!1!==n||(r=n,n=b),!1===r&&(r=S),i.each(function(e,i){o&&(l=function(e){return h(i,e.type,r),r.apply(this,arguments)}),a&&(s=function(e){var t,n=u(e.target).closest(a,i).get(0);if(n&&n!==i)return t=u.extend(v(e),{currentTarget:n,liveFired:i}),(l||r).apply(n,[t].concat(x.call(arguments,1)))}),c(i,t,r,n,a,s||l)}))},u.fn.off=function(e,n,t){var i=this;return e&&!g(e)?(u.each(e,function(e,t){i.off(e,n,t)}),i):(g(n)||w(t)||!1===t||(t=n,n=b),!1===t&&(t=S),i.each(function(){h(this,e,t,n)}))},u.fn.trigger=function(e,t){return(e=g(e)||u.isPlainObject(e)?u.Event(e):y(e))._args=t,this.each(function(){e.type in i&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):u(this).triggerHandler(e,t)})},u.fn.triggerHandler=function(n,i){var a,r;return this.each(function(e,t){(a=v(g(n)?u.Event(n):n))._args=i,a.target=t,u.each(o(t,n.type||n),function(e,t){if(r=t.proxy(a),a.isImmediatePropagationStopped())return!1})}),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){u.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),u.Event=function(e,t){g(e)||(e=(t=e).type);var n=document.createEvent(r[e]||"Events"),i=!0;if(t)for(var a in t)"bubbles"==a?i=!!t[a]:n[a]=t[a];return n.initEvent(e,i,!0),y(n)}}(D),function(v){function g(e,t,n,i){if(e.global)return a=t||j,r=n,o=i,l=v.Event(r),v(a).trigger(l,o),!l.isDefaultPrevented();var a,r,o,l}function b(e,t){var n=t.context;return!1!==t.beforeSend.call(n,e,t)&&!1!==g(t,n,"ajaxBeforeSend",[e,t])&&void g(t,n,"ajaxSend",[e,t])}function x(e,t,n,i){var a=n.context,r="success";n.success.call(a,e,r,t),i&&i.resolveWith(a,[e,r,t]),g(n,a,"ajaxSuccess",[t,n,e]),o(r,t,n)}function w(e,t,n,i,a){var r=i.context;i.error.call(r,n,t,e),a&&a.rejectWith(r,[n,t,e]),g(i,r,"ajaxError",[n,i,e||t]),o(t,n,i)}function o(e,t,n){var i,a=n.context;n.complete.call(a,t,e),g(n,a,"ajaxComplete",[t,n]),(i=n).global&&!--v.active&&g(i,null,"ajaxStop")}function C(){}function E(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function s(e,t,n,i){return v.isFunction(t)&&(i=n,n=t,t=void 0),v.isFunction(n)||(i=n,n=void 0),{url:e,data:t,success:n,dataType:i}}var S,T,u=+new Date,j=window.document,c=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,N=/^(?:text|application)\/javascript/i,k=/^(?:text|application)\/xml/i,A="application/json",O="text/html",L=/^\s*$/,P=j.createElement("a");P.href=window.location.href,v.active=0,v.ajaxJSONP=function(n,i){if(!("type"in n))return v.ajax(n);function e(e){v(l).triggerHandler("error",e||"abort")}var a,r,t=n.jsonpCallback,o=(v.isFunction(t)?t():t)||"Zepto"+u++,l=j.createElement("script"),s=window[o],c={abort:e};return i&&i.promise(c),v(l).on("load error",function(e,t){clearTimeout(r),v(l).off().remove(),"error"!=e.type&&a?x(a[0],c,n,i):w(null,t||"error",c,n,i),window[o]=s,a&&v.isFunction(s)&&s(a[0]),s=a=void 0}),!1===b(c,n)?e("abort"):(window[o]=function(){a=arguments},l.src=n.url.replace(/\?(.+)=\?/,"?$1="+o),j.head.appendChild(l),0<n.timeout&&(r=setTimeout(function(){e("timeout")},n.timeout))),c},v.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:A,xml:"application/xml, text/xml",html:O,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:C},v.ajax=function(e){var t,n,i,a,r=v.extend({},e||{}),o=v.Deferred&&v.Deferred();for(S in v.ajaxSettings)void 0===r[S]&&(r[S]=v.ajaxSettings[S]);(a=r).global&&0==v.active++&&g(a,null,"ajaxStart"),r.crossDomain||((t=j.createElement("a")).href=r.url,t.href=t.href,r.crossDomain=P.protocol+"//"+P.host!=t.protocol+"//"+t.host),r.url||(r.url=window.location.toString()),-1<(n=r.url.indexOf("#"))&&(r.url=r.url.slice(0,n)),(i=r).processData&&i.data&&"string"!=v.type(i.data)&&(i.data=v.param(i.data,i.traditional)),!i.data||i.type&&"GET"!=i.type.toUpperCase()&&"jsonp"!=i.dataType||(i.url=E(i.url,i.data),i.data=void 0);var l=r.dataType,s=/\?.+=\?/.test(r.url);if(s&&(l="jsonp"),!1!==r.cache&&(e&&!0===e.cache||"script"!=l&&"jsonp"!=l)||(r.url=E(r.url,"_="+Date.now())),"jsonp"==l)return s||(r.url=E(r.url,r.jsonp?r.jsonp+"=?":!1===r.jsonp?"":"callback=?")),v.ajaxJSONP(r,o);function c(e,t){f[e.toLowerCase()]=[e,t]}var u,d=r.accepts[l],f={},p=/^([\w-]+:)\/\//.test(r.url)?RegExp.$1:window.location.protocol,m=r.xhr(),h=m.setRequestHeader;if(o&&o.promise(m),r.crossDomain||c("X-Requested-With","XMLHttpRequest"),c("Accept",d||"*/*"),(d=r.mimeType||d)&&(-1<d.indexOf(",")&&(d=d.split(",",2)[0]),m.overrideMimeType&&m.overrideMimeType(d)),(r.contentType||!1!==r.contentType&&r.data&&"GET"!=r.type.toUpperCase())&&c("Content-Type",r.contentType||"application/x-www-form-urlencoded"),r.headers)for(T in r.headers)c(T,r.headers[T]);if(m.setRequestHeader=c,!(m.onreadystatechange=function(){if(4==m.readyState){m.onreadystatechange=C,clearTimeout(u);var e,t=!1;if(200<=m.status&&m.status<300||304==m.status||0==m.status&&"file:"==p){if(l=l||((n=(n=r.mimeType||m.getResponseHeader("content-type"))&&n.split(";",2)[0])&&(n==O?"html":n==A?"json":N.test(n)?"script":k.test(n)&&"xml")||"text"),"arraybuffer"==m.responseType||"blob"==m.responseType)e=m.response;else{e=m.responseText;try{e=function(e,t,n){if(n.dataFilter==C)return e;var i=n.context;return n.dataFilter.call(i,e,t)}(e,l,r),"script"==l?(0,eval)(e):"xml"==l?e=m.responseXML:"json"==l&&(e=L.test(e)?null:v.parseJSON(e))}catch(e){t=e}if(t)return w(t,"parsererror",m,r,o)}x(e,m,r,o)}else w(m.statusText||null,m.status?"error":"abort",m,r,o)}var n})===b(m,r))return m.abort(),w(null,"abort",m,r,o),m;var y=!("async"in r)||r.async;if(m.open(r.type,r.url,y,r.username,r.password),r.xhrFields)for(T in r.xhrFields)m[T]=r.xhrFields[T];for(T in f)h.apply(m,f[T]);return 0<r.timeout&&(u=setTimeout(function(){m.onreadystatechange=C,m.abort(),w(null,"timeout",m,r,o)},r.timeout)),m.send(r.data?r.data:null),m},v.get=function(){return v.ajax(s.apply(null,arguments))},v.post=function(){var e=s.apply(null,arguments);return e.type="POST",v.ajax(e)},v.getJSON=function(){var e=s.apply(null,arguments);return e.dataType="json",v.ajax(e)},v.fn.load=function(e,t,n){if(!this.length)return this;var i,a=this,r=e.split(/\s/),o=s(e,t,n),l=o.success;return 1<r.length&&(o.url=r[0],i=r[1]),o.success=function(e){a.html(i?v("<div>").html(e.replace(c,"")).find(i):e),l&&l.apply(a,arguments)},v.ajax(o),this};var i=encodeURIComponent;v.param=function(e,t){var n=[];return n.add=function(e,t){v.isFunction(t)&&(t=t()),null==t&&(t=""),this.push(i(e)+"="+i(t))},function n(i,e,a,r){var o,l=v.isArray(e),s=v.isPlainObject(e);v.each(e,function(e,t){o=v.type(t),r&&(e=a?r:r+"["+(s||"object"==o||"array"==o?e:"")+"]"),!r&&l?i.add(t.name,t.value):"array"==o||!a&&"object"==o?n(i,t,a,e):i.add(e,t)})}(n,e,t),n.join("&").replace(/%20/g,"+")}}(D),(P=D).fn.serializeArray=function(){var n,i,t=[],a=function(e){return e.forEach?e.forEach(a):void t.push({name:n,value:e})};return this[0]&&P.each(this[0].elements,function(e,t){i=t.type,(n=t.name)&&"fieldset"!=t.nodeName.toLowerCase()&&!t.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||t.checked)&&a(P(t).val())}),t},P.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},P.fn.submit=function(e){var t;return 0 in arguments?this.bind("submit",e):this.length&&(t=P.Event("submit"),this.eq(0).trigger(t),t.isDefaultPrevented()||this.get(0).submit()),this},function(){try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(e,t){try{return n(e,t)}catch(e){return null}}}}(),e("zepto",D)}),layui.define(["laytpl","upload","layer-mobile","zepto"],function(e){function t(){this.v="2.2.0",r(s("body"),"*[layim-event]",function(e){var t=s(this),n=t.attr("layim-event");I[n]&&I[n].call(this,t,e)})}var s=layui.zepto,c=layui.laytpl,u=layui["layer-mobile"],i=layui.device(),d="layui-show",a="layim-this",f={},r=function(e,t,n){function i(e){var t=s(this);t.data("lock")||(a||n.call(this,e),a=!1,t.data("lock","true"),setTimeout(function(){t.removeAttr("data-lock")},t.data("locktime")||0))}var a,r="function"==typeof t;return r&&(n=t),e="string"==typeof e?s(e):e,o?void(r?e.on("touchmove",function(){a=!0}).on("touchend",i):e.on("touchmove",t,function(){a=!0}).on("touchend",t,i)):void(r?e.on("click",i):e.on("click",t,i))},o=/Android|iPhone|SymbianOS|Windows Phone|iPad|iPod/.test(navigator.userAgent);u.popBottom=function(e){u.close(u.popBottom.index),u.popBottom.index=u.open(s.extend({type:1,content:e.content||"",shade:!1,className:"layim-layer"},e))},t.prototype.config=function(e){e=e||{},e=s.extend({title:"我的IM",isgroup:0,isNewFriend:!0,voice:"default.mp3",chatTitleColor:"#36373C"},e),E(e)},t.prototype.on=function(e,t){return"function"==typeof t&&(f[e]?f[e].push(t):f[e]=[t]),this},t.prototype.chat=function(e){if(window.JSON&&window.JSON.parse)return j(e,-1),this},t.prototype.panel=function(e){return T(e)},t.prototype.cache=function(){return C},t.prototype.getMessage=function(e){return P(e),this},t.prototype.addList=function(e){return M(e),this},t.prototype.removeList=function(e){return F(e),this},t.prototype.setFriendStatus=function(e,t){s(".layim-friend"+e)["online"===t?"removeClass":"addClass"]("layim-list-gray")},t.prototype.setChatStatus=function(e){return k().elem.find(".layim-chat-status").html(e),this},t.prototype.showNew=function(e,t){O(e,t)},t.prototype.content=function(e){return layui.data.content(e)};function p(e){return"history"===(e=e||{}).type&&(e.item=e.item||"d.sortHistory"),["{{# var length = 0; layui.each("+e.item+", function(i, data){ length++; }}",'<li layim-event="chat" data-type="'+e.type+'" data-index="'+(e.index?"{{"+e.index+"}}":("history"===e.type?"{{data.type}}":e.type)+"{{data.id}}")+'" class="layim-'+("history"===e.type?"{{data.type}}":e.type)+'{{data.id}} {{ data.status === "offline" ? "layim-list-gray" : "" }}"><div><img src="{{data.avatar}}"></div><span>{{ data.username||data.groupname||data.name||"佚名" }}</span><p>{{ data.remark||data.sign||"" }}</p><span class="layim-msg-status">new</span></li>',"{{# }); if(length === 0){ }}",'<li class="layim-null">'+({friend:"该分组下暂无好友",group:"暂无群组",history:"暂无任何消息"}[e.type]||"暂无数据")+"</li>","{{# } }}"].join("")}function l(e,t,n){return['<div class="layim-panel'+(t?" layui-m-anim-left":"")+'">','<div class="layim-title" style="background-color: {{d.base.chatTitleColor}};">',"<p>",n?'<i class="layui-icon layim-chat-back" layim-event="back">&#xe603;</i>':"",'{{ d.title || d.base.title }}<span class="layim-chat-status"></span>',"{{# if(d.data){ }}",'{{# if(d.data.type === "group"){ }}','<i class="layui-icon layim-chat-detail" layim-event="detail">&#xe613;</i>',"{{# } }}","{{# } }}","</p>","</div>",'<div class="layui-unselect layim-content">',e,"</div>","</div>"].join("")}function n(e){return e<10?"0"+(0|e):e}var m=['<div class="layui-layim">','<div class="layim-tab-content layui-show">','<ul class="layim-list-friend">','<ul class="layui-layim-list layui-show layim-list-history">',p({type:"history"}),"</ul>","</ul>","</div>",'<div class="layim-tab-content">','<ul class="layim-list-top">',"{{# if(d.base.isNewFriend){ }}",'<li layim-event="newFriend"><i class="layui-icon">&#xe654;</i>新的朋友<i class="layim-new" id="LAY_layimNewFriend"></i></li>',"{{# } if(d.base.isgroup){ }}",'<li layim-event="group"><i class="layui-icon">&#xe613;</i>群聊<i class="layim-new" id="LAY_layimNewGroup"></i></li>',"{{# } }}","</ul>",'<ul class="layim-list-friend">','{{# layui.each(d.friend, function(index, item){ var spread = d.local["spread"+index]; }}',"<li>",'<h5 layim-event="spread" lay-type="{{ spread }}"><i class="layui-icon">{{# if(spread === "true"){ }}&#xe61a;{{# } else {  }}&#xe602;{{# } }}</i><span>{{ item.groupname||"未命名分组"+index }}</span><em>(<cite class="layim-count"> {{ (item.list||[]).length }}</cite>)</em></h5>','<ul class="layui-layim-list {{# if(spread === "true"){ }}'," layui-show",'{{# } }}">',p({type:"friend",item:"item.list",index:"index"}),"</ul>","</li>","{{# }); if(d.friend.length === 0){ }}",'<li><ul class="layui-layim-list layui-show"><li class="layim-null">暂无联系人</li></ul>',"{{# } }}","</ul>","</div>",'<div class="layim-tab-content">','<ul class="layim-list-top">',"{{# layui.each(d.base.moreList, function(index, item){ }}",'<li layim-event="moreList" lay-filter="{{ item.alias }}">','<i class="layui-icon {{item.iconClass||""}}">{{item.iconUnicode||""}}</i>{{item.title}}<i class="layim-new" id="LAY_layimNew{{ item.alias }}"></i>',"</li>","{{# }); if(!d.base.copyright){ }}",'<li layim-event="about"><i class="layui-icon">&#xe60b;</i>关于<i class="layim-new" id="LAY_layimNewAbout"></i></li>',"{{# } }}","</ul>","</div>","</div>",'<ul class="layui-unselect layui-layim-tab">','<li title="消息" layim-event="tab" lay-type="message" class="layim-this"><i class="layui-icon">&#xe611;</i><span>消息</span><i class="layim-new" id="LAY_layimNewMsg"></i></li>','<li title="联系人" layim-event="tab" lay-type="friend"><i class="layui-icon">&#xe612;</i><span>联系人</span><i class="layim-new" id="LAY_layimNewList"></i></li>','<li title="更多" layim-event="tab" lay-type="more"><i class="layui-icon">&#xe670;</i><span>更多</span><i class="layim-new" id="LAY_layimNewMore"></i></li>',"</ul>"].join(""),h=['<div class="layim-chat layim-chat-{{d.data.type}}">','<div class="layim-chat-main">',"<ul></ul>","</div>",'<div class="layim-chat-footer">','<div class="layim-chat-send"><input type="text" autocomplete="off"><button class="layim-send layui-disabled" layim-event="send">发送</button></div>','<div class="layim-chat-tool" data-json="{{encodeURIComponent(JSON.stringify(d.data))}}">','<span class="layui-icon layim-tool-face" title="选择表情" layim-event="face">&#xe60c;</span>',"{{# if(d.base && d.base.uploadImage){ }}",'<span class="layui-icon layim-tool-image" title="上传图片" layim-event="image">&#xe60d;<input type="file" name="file" accept="image/*"></span>',"{{# }; }}","{{# if(d.base && d.base.uploadFile){ }}",'<span class="layui-icon layim-tool-image" title="发送文件" layim-event="image" data-type="file">&#xe61d;<input type="file" name="file"></span>',"{{# }; }}","{{# layui.each(d.base.tool, function(index, item){ }}",'<span class="layui-icon  {{item.iconClass||""}} layim-tool-{{item.alias}}" title="{{item.title}}" layim-event="extend" lay-filter="{{ item.alias }}">{{item.iconUnicode||""}}</span>',"{{# }); }}","</div>","</div>","</div>"].join("");layui.data.date=function(e){var t=new Date(e||new Date);return n(t.getMonth()+1)+"-"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())},layui.data.content=function(e){function t(e){return new RegExp("\\n*\\["+(e||"")+"(pre|div|p|table|thead|th|tbody|tr|td|ul|li|ol|li|dl|dt|dd|h2|h3|h4|h5)([\\s\\S]*?)\\]\\n*","g")}return(e||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/@(\S+)(\s+?|$)/g,'@<a href="javascript:;">$1</a>$2').replace(/face\[([^\s\[\]]+?)\]/g,function(e){var t=e.replace(/^face/g,"");return'<img alt="'+t+'" title="'+t+'" src="'+_[t]+'">'}).replace(/img\[([^\s]+?)\]/g,function(e){return'<img class="layui-layim-photos" src="'+e.replace(/(^img\[)|(\]$)/g,"")+'">'}).replace(/file\([\s\S]+?\)\[[\s\S]*?\]/g,function(e){var t=(e.match(/file\(([\s\S]+?)\)\[/)||[])[1],n=(e.match(/\)\[([\s\S]*?)\]/)||[])[1];return t?'<a class="layui-layim-file" href="'+t+'" download target="_blank"><i class="layui-icon">&#xe61e;</i><cite>'+(n||t)+"</cite></a>":e}).replace(/audio\[([^\s]+?)\]/g,function(e){return'<div class="layui-unselect layui-layim-audio" layim-event="playAudio" data-src="'+e.replace(/(^audio\[)|(\]$)/g,"")+'"><i class="layui-icon">&#xe652;</i><p>音频消息</p></div>'}).replace(/video\[([^\s]+?)\]/g,function(e){return'<div class="layui-unselect layui-layim-video" layim-event="playVideo" data-src="'+e.replace(/(^video\[)|(\]$)/g,"")+'"><i class="layui-icon">&#xe652;</i></div>'}).replace(/a\([\s\S]+?\)\[[\s\S]*?\]/g,function(e){var t=(e.match(/a\(([\s\S]+?)\)\[/)||[])[1],n=(e.match(/\)\[([\s\S]*?)\]/)||[])[1];return t?'<a href="'+t+'" target="_blank">'+(n||t)+"</a>":e}).replace(t(),"<$1 $2>").replace(t("/"),"</$1>").replace(/\n/g,"<br>")};function y(e){var t,n,i,a,r,o=layui.data("layim-mobile")[C.mine.id]||{},l={},s=o.history||{};s[e.type+e.id],g&&(t=g.find(".layim-list-history"),e.historyTime=(new Date).getTime(),e.sign=e.content,s[e.type+e.id]=e,o.history=s,layui.data("layim-mobile",{key:C.mine.id,value:o}),n=t.find(".layim-"+e.type+e.id),i=(C.message[e.type+e.id]||[]).length,a=function(){(n=t.find(".layim-"+e.type+e.id)).find("p").html(e.content),0<i&&n.find(".layim-msg-status").html(i).addClass(d)},0<n.length?(a(),t.prepend(n.clone()),n.remove()):(l[e.type+e.id]=e,r=c(p({type:"history",item:"d.data"})).render({data:l}),t.prepend(r),a(),t.find(".layim-null").remove()),O("Msg"))}function v(e,t,n){var i,a=e.value;n||e.focus(),document.selection?(i=document.selection.createRange(),document.selection.empty(),i.text=t):(i=[a.substring(0,e.selectionStart),t,a.substr(e.selectionEnd)],n||e.focus(),e.value=i.join(""))}var g,b,x,w=['<li class="layim-chat-li{{ d.mine ? " layim-chat-mine" : "" }}">','<div class="layim-chat-user"><img src="{{ d.avatar }}" alt="{{ d.uid || d.id }}"><cite>','{{ d.username||"佚名" }}',"</cite></div>",'<div class="layim-chat-text">{{ layui.data.content(d.content||"&nbsp;") }}</div>',"</li>"].join(""),C={message:{},chat:[]},E=function(a){var e=a.init||{};return mine=e.mine||{},local=layui.data("layim-mobile")[mine.id]||{},obj={base:a,local:local,mine:mine,history:local.history||[]},create=function(e){var t=e.mine||{},n=layui.data("layim-mobile")[t.id]||{},i={base:a,local:n,mine:t,friend:e.friend||[],group:e.group||[],history:n.history||[]};i.sortHistory=A(i.history,"historyTime"),C=s.extend(C,i),S(c(l(m)).render(i)),layui.each(f.ready,function(e,t){t&&t(i)})},C=s.extend(C,obj),a.brief?layui.each(f.ready,function(e,t){t&&t(obj)}):void create(e)},S=function(e){return u.open({type:1,shade:!1,shadeClose:!1,anim:-1,content:e,success:function(e){g=s(e),N(g.find(".layui-layim")),C.base.tabIndex&&I.tab(s(".layui-layim-tab>li").eq(C.base.tabIndex))}})},T=function(n,e){n=n||{};var t=s.extend({},C,{title:n.title||"",data:n.data});return u.open({type:1,shade:!1,shadeClose:!1,anim:-1,content:c(l(n.tpl,-1!==e,!0)).render(t),success:function(e){var t=s(e);t.prev().find(".layim-panel").addClass("layui-m-anim-lout"),n.success&&n.success(e),n.isChat||N(t.find(".layim-content"))},end:n.end})},j=function(i,e,t){return(i=i||{}).id?(u.close(j.index),j.index=T({tpl:h,data:i,title:i.name,isChat:!0,success:function(e){b=s(e),H(),$(),delete C.message[i.type+i.id],O("Msg");var n=k(),t=n.elem.find(".layim-chat-main");layui.each(f.chatChange,function(e,t){t&&t(n)}),N(t),n.textarea.on("focus",function(){setTimeout(function(){t.scrollTop(t[0].scrollHeight+1e3)},500)})},end:function(){b=null,L.time=0}},e)):u.msg("非法用户")},N=function(n){i.ios&&n.on("touchmove",function(e){var t=n.scrollTop();t<=0&&(n.scrollTop(1),e.preventDefault(e)),this.scrollHeight-t-n.height()<=0&&(n.scrollTop(n.scrollTop()-1),e.preventDefault(e))})},k=function(){if(!b)return{};var e=b.find(".layim-chat"),t=JSON.parse(decodeURIComponent(e.find(".layim-chat-tool").data("json")));return{elem:e,data:t,textarea:e.find("input")}},A=function(e,a,t){var n=[];return layui.each(e,function(e,t){n.push(t)}),n.sort(function(e,t){var n=e[a],i=t[a];return i<n?-1:n<i?1:0}),t&&n.reverse(),n},O=function(e,t){t||layui.each(C.message,function(){return!(t=!0)}),s("#LAY_layimNew"+e)[t?"addClass":"removeClass"](d)},L=function(){var e={username:C.mine?C.mine.username:"访客",avatar:C.mine?C.mine.avatar:layui.cache.dir+"css/pc/layim/skin/logo.jpg",id:C.mine?C.mine.id:null,mine:!0},t=k(),n=t.elem.find(".layim-chat-main ul"),i=t.data,a=C.base.maxLength||3e3,r=(new Date).getTime(),o=t.textarea;if(e.content=o.val(),""!==e.content){if(e.content.length>a)return u.msg("内容最长不能超过"+a+"个字符");6e4<r-(L.time||0)&&(n.append('<li class="layim-chat-system"><span>'+layui.data.date()+"</span></li>"),L.time=r),n.append(c(w).render(e));var l={mine:e,to:i},s={username:l.mine.username,avatar:l.mine.avatar,id:i.id,type:i.type,content:l.mine.content,timestamp:r,mine:!0};D(s),layui.each(f.sendMessage,function(e,t){t&&t(l)}),i.content=e.content,y(i),q(),o.val(""),o.next().addClass("layui-disabled")}},P=function(n){n=n||{};var e,i={},t=k().data||{},a=t.id==n.id&&t.type==n.type;n.timestamp=n.timestamp||(new Date).getTime(),n.system||D(n),console.log(n),JSON.parse(JSON.stringify(n)),C.base.voice&&((e=document.createElement("audio")).src=layui.cache.dir+"css/modules/layim/voice/"+C.base.voice,e.play()),(b||!n.content)&&a||(C.message[n.type+n.id]?C.message[n.type+n.id].push(n):C.message[n.type+n.id]=[n]);var r,i={};"friend"===n.type?(layui.each(C.friend,function(e,t){if(layui.each(t.list,function(e,t){if(t.id==n.id)return n.type="friend",n.name=t.username,r=!0}),r)return!0}),r||(n.temporary=!0)):"group"===n.type?layui.each(C.group,function(e,t){if(t.id==n.id)return n.type="group",n.name=n.groupname=t.groupname,i.avatar=t.avatar,!0}):n.name=n.name||n.username||n.groupname;var o,l=s.extend({},n,{avatar:i.avatar||n.avatar});"group"===n.type&&delete l.username,y(l),b&&a&&(o=b.find(".layim-chat").find(".layim-chat-main ul"),n.system?o.append('<li class="layim-chat-system"><span>'+n.content+"</span></li>"):""!==n.content.replace(/\s/g,"")&&(6e4<n.timestamp-(L.time||0)&&(o.append('<li class="layim-chat-system"><span>'+layui.data.date(n.timestamp)+"</span></li>"),L.time=n.timestamp),o.append(c(w).render(n))),q())},D=function(e){var t=layui.data("layim-mobile")[C.mine.id]||{},n=t.chatlog||{};n[e.type+e.id]?(n[e.type+e.id].push(e),20<n[e.type+e.id].length&&n[e.type+e.id].shift()):n[e.type+e.id]=[e],t.chatlog=n,layui.data("layim-mobile",{key:C.mine.id,value:t})},$=function(){var e=layui.data("layim-mobile")[C.mine.id]||{},t=k(),n=e.chatlog||{},i=t.elem.find(".layim-chat-main ul");layui.each(n[t.data.type+t.data.id],function(e,t){(new Date).getTime()>t.timestamp&&6e4<t.timestamp-(L.time||0)&&(i.append('<li class="layim-chat-system"><span>'+layui.data.date(t.timestamp)+"</span></li>"),L.time=t.timestamp),i.append(c(w).render(t))}),q()},M=function(n){var i,e,t,a={},r=g.find(".layim-list-"+n.type);if(C[n.type])if("friend"===n.type)layui.each(C.friend,function(e,t){if(n.groupid==t.id)return layui.each(C.friend[e].list,function(e,t){if(t.id==n.id)return i=!0}),i?u.msg("好友 ["+(n.username||"")+"] 已经存在列表中",{anim:6}):(C.friend[e].list=C.friend[e].list||[],(a[C.friend[e].list.length]=n).groupIndex=e,C.friend[e].list.push(n),!0)});else if("group"===n.type){if(layui.each(C.group,function(e,t){if(t.id==n.id)return i=!0}),i)return u.msg("您已是 ["+(n.groupname||"")+"] 的群成员",{anim:6});a[C.group.length]=n,C.group.push(n)}i||(e=c(p({type:n.type,item:"d.data",index:"friend"===n.type?"data.groupIndex":null})).render({data:a}),"friend"===n.type?((t=r.children("li").eq(n.groupIndex)).find(".layui-layim-list").append(e),t.find(".layim-count").html(C.friend[n.groupIndex].list.length),t.find(".layim-null")[0]&&t.find(".layim-null").remove()):"group"===n.type&&(r.append(e),r.find(".layim-null")[0]&&r.find(".layim-null").remove()))},F=function(a){var r=g.find(".layim-list-"+a.type);C[a.type]&&("friend"===a.type?layui.each(C.friend,function(i,e){layui.each(e.list,function(e,t){if(a.id==t.id){var n=r.children("li").eq(i);return n.find(".layui-layim-list").children("li"),n.find(".layui-layim-list").children("li").eq(e).remove(),C.friend[i].list.splice(e,1),n.find(".layim-count").html(C.friend[i].list.length),0===C.friend[i].list.length&&n.find(".layui-layim-list").html('<li class="layim-null">该分组下已无好友了</li>'),!0}})}):"group"===a.type&&layui.each(C.group,function(e,t){if(a.id==t.id)return r.children("li").eq(e).remove(),C.group.splice(e,1),0===C.group.length&&r.html('<li class="layim-null">暂无群组</li>'),!0}))},q=function(){var e,t=k().elem.find(".layim-chat-main"),n=t.find("ul"),i=n.children(".layim-chat-li");20<=i.length&&((e=i.eq(0)).prev().remove(),n.prev().hasClass("layim-chat-system")||n.before('<div class="layim-chat-system"><span layim-event="chatLog">查看更多记录</span></div>'),e.remove()),t.scrollTop(t[0].scrollHeight+1e3)},H=function(){var t=k().textarea,n=t.next();t.off("keyup").on("keyup",function(e){13===e.keyCode&&(e.preventDefault(),L()),n[""===t.val()?"addClass":"removeClass"]("layui-disabled")})},_=(x={},layui.each(["[微笑]","[嘻嘻]","[哈哈]","[可爱]","[可怜]","[挖鼻]","[吃惊]","[害羞]","[挤眼]","[闭嘴]","[鄙视]","[爱你]","[泪]","[偷笑]","[亲亲]","[生病]","[太开心]","[白眼]","[右哼哼]","[左哼哼]","[嘘]","[衰]","[委屈]","[吐]","[哈欠]","[抱抱]","[怒]","[疑问]","[馋嘴]","[拜拜]","[思考]","[汗]","[困]","[睡]","[钱]","[失望]","[酷]","[色]","[哼]","[鼓掌]","[晕]","[悲伤]","[抓狂]","[黑线]","[阴险]","[怒骂]","[互粉]","[心]","[伤心]","[猪头]","[熊猫]","[兔子]","[ok]","[耶]","[good]","[NO]","[赞]","[来]","[弱]","[草泥马]","[神马]","[囧]","[浮云]","[给力]","[围观]","[威武]","[奥特曼]","[礼物]","[钟]","[话筒]","[蜡烛]","[蛋糕]"],function(e,t){x[t]=layui.cache.dir+"images/face/"+e+".gif"}),x),z=layui.stope,I={chat:function(e){var t=layui.data("layim-mobile")[C.mine.id]||{},n=e.data("type"),i=e.data("index"),a=e.attr("data-list")||e.index(),r={};"friend"===n?r=C[n][i].list[a]:"group"===n?r=C[n][a]:"history"===n&&(r=(t.history||{})[i]||{}),r.name=r.name||r.username||r.groupname,"history"!==n&&(r.type=n),j(r,!0),s(".layim-"+r.type+r.id).find(".layim-msg-status").removeClass(d)},spread:function(e){var t=e.attr("lay-type"),n="true"===t?"false":"true",i=layui.data("layim-mobile")[C.mine.id]||{};e.next()["true"===t?"removeClass":"addClass"](d),i["spread"+e.parent().index()]=n,layui.data("layim-mobile",{key:C.mine.id,value:i}),e.attr("lay-type",n),e.find(".layui-icon").html("true"==n?"&#xe61a;":"&#xe602;")},tab:function(e){var t=e.index(),n=".layim-tab-content";e.addClass(a).siblings().removeClass(a),g.find(n).eq(t).addClass(d).siblings(n).removeClass(d)},back:function(e){var t=e.parents(".layui-m-layer").eq(0),n=t.attr("index"),i=".layim-panel";setTimeout(function(){u.close(n)},300),e.parents(i).eq(0).removeClass("layui-m-anim-left").addClass("layui-m-anim-rout"),t.prev().find(i).eq(0).removeClass("layui-m-anim-lout").addClass("layui-m-anim-right"),layui.each(f.back,function(e,t){setTimeout(function(){t&&t()},200)})},send:function(){L()},face:function(e,t){var n="",i=k().textarea;layui.each(_,function(e,t){n+='<li title="'+e+'"><img src="'+t+'"></li>'}),n='<ul class="layui-layim-face">'+n+"</ul>",u.popBottom({content:n,success:function(e){var t=s(e).find(".layui-layim-face").children("li");r(t,function(){return v(i[0],"face"+this.title+" ",!0),i.next()[""===i.val()?"addClass":"removeClass"]("layui-disabled"),!1})}});var a=s(document);o?r(a,function(){I.faceHide()}):a.off("click",I.faceHide).on("click",I.faceHide),z(t)},faceHide:function(){u.close(u.popBottom.index),s(document).off("touchend",I.faceHide).off("click",I.faceHide)},image:function(e){var t=e.data("type")||"images",n=k(),i=C.base[{images:"uploadImage",file:"uploadFile"}[t]]||{};layui.upload.render({url:i.url||"",method:i.type,elem:e.find("input")[0],accept:t,done:function(e){0==e.code?(e.data=e.data||{},"images"===t?v(n.textarea[0],"img["+(e.data.src||"")+"]"):"file"===t&&v(n.textarea[0],"file("+(e.data.src||"")+")["+(e.data.name||"下载文件")+"]"),L()):u.msg(e.msg||"上传失败")}})},extend:function(n){var e=n.attr("lay-filter"),i=k();layui.each(f["tool("+e+")"],function(e,t){t&&t.call(n,function(e){v(i.textarea[0],e)},L,i)})},newFriend:function(){layui.each(f.newFriend,function(e,t){t&&t()})},group:function(){T({title:"群聊",tpl:['<div class="layui-layim-list layim-list-group">',p({type:"group",item:"d.group"}),"</div>"].join(""),data:{}})},detail:function(){var n=k();layui.each(f.detail,function(e,t){t&&t(n.data)})},playAudio:function(e){function t(){i.pause(),e.removeAttr("status"),e.find("i").html("&#xe652;")}var n=e.data("audio"),i=n||document.createElement("audio");return e.data("error")?u.msg("播放音频源异常"):i.play?void(e.attr("status")?t():(n||(i.src=e.data("src")),i.play(),e.attr("status","pause"),e.data("audio",i),e.find("i").html("&#xe651;"),i.onended=function(){t()},i.onerror=function(){u.msg("播放音频源异常"),e.data("error",!0),t()})):u.msg("您的浏览器不支持audio")},playVideo:function(e){var t=e.data("src");return document.createElement("video").play?(u.close(I.playVideo.index),void(I.playVideo.index=u.open({type:1,anim:!1,style:"width: 100%; height: 50%;",content:'<div style="background-color: #000; height: 100%;"><video style="position: absolute; width: 100%; height: 100%;" src="'+t+'" autoplay="autoplay"></video></div>'}))):u.msg("您的浏览器不支持video")},chatLog:function(e){var n=k();layui.each(f.chatlog,function(e,t){t&&t(n.data,n.elem.find(".layim-chat-main>ul"))})},moreList:function(e){var n=e.attr("lay-filter");layui.each(f.moreList,function(e,t){t&&t({alias:n})})},about:function(){u.open({content:'<p style="padding-bottom: 5px;">LayIM属于付费产品，欢迎通过官网获得授权，促进良性发展！</p><p>当前版本：layim mobile v2.2.0</p><p>版权所有：<a href="http://layim.layui.com" target="_blank">layim.layui.com</a></p>',className:"layim-about",shadeClose:!1,btn:"我知道了"})}};e("layim-mobile",new t)}).addcss("modules/layim/mobile/layim.css?v=2.20","skinlayim-mobilecss"),layui["layui.mobile"]||layui.config({base:layui.cache.dir+"lay/modules/mobile/"}).extend({"layer-mobile":"layer-mobile",zepto:"zepto","upload-mobile":"upload-mobile","layim-mobile":"layim-mobile"}),layui.define(["layer-mobile","zepto","layim-mobile"],function(e){e("mobile",{layer:layui["layer-mobile"],layim:layui["layim-mobile"]})});